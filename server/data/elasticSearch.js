
const client = require('../config/elasticConnection.js');

const exportedMethods = {
    async createIndex(indexName) {
        client.indices.create({
            index: "restaurants",
            body: {
                "mappings" : {
                    "properties" : {
                      "alias" : {
                        "type" : "text",
                        "fields" : {
                          "keyword" : {
                            "type" : "keyword",
                            "ignore_above" : 256
                          }
                        }
                      },
                      "categories" : {
                        "properties" : {
                          "alias" : {
                            "type" : "text",
                            "fields" : {
                              "keyword" : {
                                "type" : "keyword",
                                "ignore_above" : 256
                              }
                            }
                          },
                          "title" : {
                            "type" : "text",
                            "fields" : {
                              "keyword" : {
                                "type" : "keyword",
                                "ignore_above" : 256
                              }
                            }
                          }
                        }
                      },
                      "id" : {
                        "type" : "text",
                        "index" : false
                        
                      },
                      "name" : {
                        "type" : "text",
                        "fields" : {
                          "keyword" : {
                            "type" : "keyword",
                            "ignore_above" : 256
                          }
                        }
                      }
                    }
                  }
                }
        }, function (err, resp, respcode) {
            console.log(err, resp, respcode);
        });

        this.addToIndex();
    },

    async addToIndex() {
let restaurants = [{"id":"H4jJ7XB3CetIr1pg56CczQ","alias":"levain-bakery-new-york","name":"Levain Bakery","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/jCdrXah--NjPaOLb-30BUw/o.jpg","categories":[{"alias":"bakeries","title":"Bakeries"}],"location":{"address1":"167 W 74th St","address2":"","address3":"","city":"New York","zip_code":"10023","country":"US","state":"NY","display_address":["167 W 74th St","New York, NY 10023"]}},{"id":"jVncyqXwlx_D9f2xZn05tg","alias":"the-metropolitan-museum-of-art-new-york-3","name":"The Metropolitan Museum of Art","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/UZ5-dy--YG4nq9dXqgsQaw/o.jpg","categories":[{"alias":"artmuseums","title":"Art Museums"}],"location":{"address1":"1000 5th Ave","address2":"","address3":"","city":"New York","zip_code":"10028","country":"US","state":"NY","display_address":["1000 5th Ave","New York, NY 10028"]}},{"id":"V7lXZKBDzScDeGB8JmnzSA","alias":"katzs-delicatessen-new-york","name":"Katz's Delicatessen","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/B6xNx79cSE7bFxqERBYOhg/o.jpg","categories":[{"alias":"delis","title":"Delis"},{"alias":"sandwiches","title":"Sandwiches"},{"alias":"catering","title":"Caterers"}],"location":{"address1":"205 E Houston St","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["205 E Houston St","New York, NY 10003"]}},{"id":"44SY464xDHbvOcjDzRbKkQ","alias":"ippudo-ny-new-york-7","name":"Ippudo NY","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/zF3EgqHCk7zBUwD2B3WTEA/o.jpg","categories":[{"alias":"ramen","title":"Ramen"}],"location":{"address1":"65 4th Ave","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["65 4th Ave","New York, NY 10003"]}},{"id":"xEnNFXtMLDF5kZDxfaCJgA","alias":"the-halal-guys-new-york-2","name":"The Halal Guys","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/24lb-VP2zVySsY9cq45ETw/o.jpg","categories":[{"alias":"foodstands","title":"Food Stands"},{"alias":"mideastern","title":"Middle Eastern"},{"alias":"halal","title":"Halal"}],"location":{"address1":"W 53rd St 6th Ave","address2":null,"address3":"","city":"New York","zip_code":"10019","country":"US","state":"NY","display_address":["W 53rd St 6th Ave","New York, NY 10019"]}},{"id":"veq1Bl1DW3UWMekZJUsG1Q","alias":"gramercy-tavern-new-york","name":"Gramercy Tavern","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/1C20qnil3QUWRl3om2gOFg/o.jpg","categories":[{"alias":"newamerican","title":"American (New)"}],"location":{"address1":"42 E 20th St","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["42 E 20th St","New York, NY 10003"]}},{"id":"xOw4aafJRji9XomGunlvcQ","alias":"central-park-new-york","name":"Central Park","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/a_T1R7oNyM-5Vtcx5ZiyPw/o.jpg","categories":[{"alias":"parks","title":"Parks"}],"location":{"address1":"14 E 60th St","address2":"","address3":"Central Park Conservancy","city":"New York","zip_code":"10022","country":"US","state":"NY","display_address":["14 E 60th St","Central Park Conservancy","New York, NY 10022"]}},{"id":"jnEv25Y2DosTq2sNnvmC9g","alias":"los-tacos-no-1-new-york","name":"Los Tacos No.1","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/FU44TYl3PzXsE06G4W5aog/o.jpg","categories":[{"alias":"tacos","title":"Tacos"}],"location":{"address1":"75 9th Ave","address2":"","address3":"","city":"New York","zip_code":"10011","country":"US","state":"NY","display_address":["75 9th Ave","New York, NY 10011"]}},{"id":"WHRHK3S1mQc3PmhwsGRvbw","alias":"bibble-and-sip-new-york-2","name":"Bibble & Sip","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/b4_G7Dc2l1hpHlTjH48kuw/o.jpg","categories":[{"alias":"coffee","title":"Coffee & Tea"},{"alias":"bakeries","title":"Bakeries"}],"location":{"address1":"253 W 51st St","address2":"","address3":"","city":"New York","zip_code":"10019","country":"US","state":"NY","display_address":["253 W 51st St","New York, NY 10019"]}},{"id":"UA2M9QFZghe-9th2KwLoWQ","alias":"burger-and-lobster-new-york-4","name":"Burger & Lobster","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/1rHd7F4zztAsScwzM0vDmw/o.jpg","categories":[{"alias":"seafood","title":"Seafood"},{"alias":"burgers","title":"Burgers"},{"alias":"newamerican","title":"American (New)"}],"location":{"address1":"39 W 19th St","address2":"","address3":"","city":"New York","zip_code":"10011","country":"US","state":"NY","display_address":["39 W 19th St","New York, NY 10011"]}},{"id":"4yPqqJDJOQX69gC66YUDkA","alias":"peter-luger-brooklyn-2","name":"Peter Luger","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/DnReRUkXRtsmKycQEYl0pg/o.jpg","categories":[{"alias":"steak","title":"Steakhouses"}],"location":{"address1":"178 Broadway","address2":"","address3":"","city":"Brooklyn","zip_code":"11211","country":"US","state":"NY","display_address":["178 Broadway","Brooklyn, NY 11211"]}},{"id":"jjJc_CrkB2HodEinB6cWww","alias":"lovemama-new-york","name":"LoveMama","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/bLlFKTlVuLfmF-lIDGIjZA/o.jpg","categories":[{"alias":"thai","title":"Thai"},{"alias":"malaysian","title":"Malaysian"},{"alias":"vietnamese","title":"Vietnamese"}],"location":{"address1":"174 2nd Ave","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["174 2nd Ave","New York, NY 10003"]}},{"id":"JION8hhg7q6zyayHYwhxIw","alias":"the-high-line-new-york","name":"The High Line","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/Gujj42hSygQGqua-R4iYiQ/o.jpg","categories":[{"alias":"parks","title":"Parks"},{"alias":"localflavor","title":"Local Flavor"}],"location":{"address1":"820 Washington St","address2":"","address3":"","city":"New York","zip_code":"10014","country":"US","state":"NY","display_address":["820 Washington St","New York, NY 10014"]}},{"id":"lWOkeS-wV4no8qqA9OwwEg","alias":"doughnut-plant-new-york-6","name":"Doughnut Plant","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/JpLMXFWyvpstlC9__dlJKA/o.jpg","categories":[{"alias":"donuts","title":"Donuts"},{"alias":"coffee","title":"Coffee & Tea"}],"location":{"address1":"379 Grand St","address2":"","address3":"","city":"New York","zip_code":"10002","country":"US","state":"NY","display_address":["379 Grand St","New York, NY 10002"]}},{"id":"j1S3NUrkB3BVT49n_e76NQ","alias":"best-bagel-and-coffee-new-york","name":"Best Bagel & Coffee","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/9-8DVzhwfzFS5GUCq3O6NA/o.jpg","categories":[{"alias":"bagels","title":"Bagels"},{"alias":"coffee","title":"Coffee & Tea"},{"alias":"breakfast_brunch","title":"Breakfast & Brunch"}],"location":{"address1":"225 W 35th St","address2":"","address3":"","city":"New York","zip_code":"10001","country":"US","state":"NY","display_address":["225 W 35th St","New York, NY 10001"]}},{"id":"zj8Lq1T8KIC5zwFief15jg","alias":"prince-street-pizza-new-york-2","name":"Prince Street Pizza","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/ZAukOyv530w4KjOHC5YY1w/o.jpg","categories":[{"alias":"pizza","title":"Pizza"},{"alias":"italian","title":"Italian"}],"location":{"address1":"27 Prince St","address2":null,"address3":"","city":"New York","zip_code":"10012","country":"US","state":"NY","display_address":["27 Prince St","New York, NY 10012"]}},{"id":"FEVQpbOPOwAPNIgO7D3xxw","alias":"shake-shack-new-york-2","name":"Shake Shack","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/J0UoRJKdaMl0EPdgxYIlKw/o.jpg","categories":[{"alias":"burgers","title":"Burgers"},{"alias":"foodstands","title":"Food Stands"},{"alias":"icecream","title":"Ice Cream & Frozen Yogurt"}],"location":{"address1":"Madison Square Park","address2":"","address3":"E 23rd St & Madison Ave","city":"New York","zip_code":"10010","country":"US","state":"NY","display_address":["Madison Square Park","E 23rd St & Madison Ave","New York, NY 10010"]}},{"id":"nU4XBdvxDABXqZ6CnB8Dig","alias":"clinton-street-baking-company-new-york-5","name":"Clinton Street Baking Company","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/DWHdizJ9bKbXN4yq6nbwAA/o.jpg","categories":[{"alias":"bakeries","title":"Bakeries"},{"alias":"breakfast_brunch","title":"Breakfast & Brunch"},{"alias":"tradamerican","title":"American (Traditional)"}],"location":{"address1":"4 Clinton St","address2":"","address3":"","city":"New York","zip_code":"10002","country":"US","state":"NY","display_address":["4 Clinton St","New York, NY 10002"]}},{"id":"vRrVSB-LegwUwIxpkeRVtQ","alias":"le-bernardin-new-york","name":"Le Bernardin","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/G0wZ6h5KaQG2gJkk8uOkLQ/o.jpg","categories":[{"alias":"french","title":"French"},{"alias":"lounges","title":"Lounges"}],"location":{"address1":"155 W 51st St","address2":"","address3":"The Equitable Bldg","city":"New York","zip_code":"10019","country":"US","state":"NY","display_address":["155 W 51st St","The Equitable Bldg","New York, NY 10019"]}},{"id":"kViIWJFfAfWPpJOwAXBKGA","alias":"national-september-11-memorial-museum-new-york","name":"National September 11 Memorial Museum","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/gFr_zDiUm8QJ-4gkG8v6Uw/o.jpg","categories":[{"alias":"museums","title":"Museums"}],"location":{"address1":"180 Greenwich St","address2":"","address3":"","city":"New York","zip_code":"10007","country":"US","state":"NY","display_address":["180 Greenwich St","New York, NY 10007"]}},{"id":"UGECJrPSWy0n7PXykBBWAQ","alias":"two-little-red-hens-new-york-4","name":"Two Little Red Hens","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/gF02Oh2PfE2OS7Nz3MqV4g/o.jpg","categories":[{"alias":"bakeries","title":"Bakeries"},{"alias":"desserts","title":"Desserts"},{"alias":"coffee","title":"Coffee & Tea"}],"location":{"address1":"1652 2nd Ave","address2":null,"address3":"","city":"New York","zip_code":"10028","country":"US","state":"NY","display_address":["1652 2nd Ave","New York, NY 10028"]}},
{"id":"mvn2XFJfIPNAlvsy-arzkA","alias":"brooklyn-bridge-brooklyn","name":"Brooklyn Bridge","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/1F5Xl0Qn5DW8nzaelPSwMA/o.jpg","categories":[{"alias":"landmarks","title":"Landmarks & Historical Buildings"}],"location":{"address1":"334 Furman St","address2":null,"address3":"","city":"Brooklyn","zip_code":"11201","country":"US","state":"NY","display_address":["334 Furman St","Brooklyn, NY 11201"]}},{"id":"nI1UYDCYUTt23TpGxqnLKg","alias":"buddakan-new-york","name":"Buddakan","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/Avw19VU35-FZLen3nl9gYw/o.jpg","categories":[{"alias":"chinese","title":"Chinese"},{"alias":"bars","title":"Bars"},{"alias":"asianfusion","title":"Asian Fusion"}],"location":{"address1":"75 9th Ave","address2":null,"address3":"","city":"New York","zip_code":"10011","country":"US","state":"NY","display_address":["75 9th Ave","New York, NY 10011"]}},{"id":"ga6sRtE0l85iftw_5-W84Q","alias":"dominique-ansel-bakery-new-york","name":"Dominique Ansel Bakery","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/fs7t18Em3AqLqsQY_l_2_w/o.jpg","categories":[{"alias":"bakeries","title":"Bakeries"},{"alias":"desserts","title":"Desserts"}],"location":{"address1":"189 Spring St","address2":"","address3":"","city":"New York","zip_code":"10012","country":"US","state":"NY","display_address":["189 Spring St","New York, NY 10012"]}},{"id":"B3_K2kUVbYOU0VaLcj_LTw","alias":"thai-villa-new-york-2","name":"Thai Villa","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/OgCU9NPFIl8hF_04Zani9w/o.jpg","categories":[{"alias":"thai","title":"Thai"},{"alias":"asianfusion","title":"Asian Fusion"},{"alias":"vegetarian","title":"Vegetarian"}],"location":{"address1":"5 E 19th St","address2":"G Floor","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["5 E 19th St","G Floor","New York, NY 10003"]}},{"id":"ETgJqJHV7BW6pIr9Ox74sA","alias":"amélie-new-york","name":"Amélie","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/cSDgVuPMnJgMLTrTNSEXug/o.jpg","categories":[{"alias":"french","title":"French"},{"alias":"wine_bars","title":"Wine Bars"}],"location":{"address1":"22 W 8th St","address2":"","address3":"","city":"New York","zip_code":"10011","country":"US","state":"NY","display_address":["22 W 8th St","New York, NY 10011"]}},{"id":"a0IET3_yCFcO36OqGSsisg","alias":"eataly-nyc-flatiron-new-york","name":"Eataly NYC Flatiron","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/9Xzihhf_KcZieyru9TX-pg/o.jpg","categories":[{"alias":"italian","title":"Italian"},{"alias":"grocery","title":"Grocery"},{"alias":"cafes","title":"Cafes"}],"location":{"address1":"200 5th Ave","address2":"","address3":"","city":"New York","zip_code":"10010","country":"US","state":"NY","display_address":["200 5th Ave","New York, NY 10010"]}},{"id":"A_YpTLbAlEqeLVSs9bxbEA","alias":"club-a-steakhouse-new-york","name":"Club A Steakhouse","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/8UNPe4NiTidCHN2VpxGbfg/o.jpg","categories":[{"alias":"steak","title":"Steakhouses"}],"location":{"address1":"240 E 58th St","address2":"","address3":"","city":"New York","zip_code":"10022","country":"US","state":"NY","display_address":["240 E 58th St","New York, NY 10022"]}},{"id":"ysqgdbSrezXgVwER2kQWKA","alias":"julianas-pizza-brooklyn-5","name":"Juliana's Pizza","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/7JtwTxhWHf3YS70Ss_CfxA/o.jpg","categories":[{"alias":"pizza","title":"Pizza"}],"location":{"address1":"19 Old Fulton St","address2":"","address3":"","city":"Brooklyn","zip_code":"11201","country":"US","state":"NY","display_address":["19 Old Fulton St","Brooklyn, NY 11201"]}},{"id":"vk7W3_sQwr7eZbRFsXv6rw","alias":"taiyaki-nyc-new-york","name":"Taiyaki NYC","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/Iyj-1IhhvtdNWycNJS17iw/o.jpg","categories":[{"alias":"icecream","title":"Ice Cream & Frozen Yogurt"}],"location":{"address1":"119 Baxter St","address2":"","address3":null,"city":"New York","zip_code":"10013","country":"US","state":"NY","display_address":["119 Baxter St","New York, NY 10013"]}},{"id":"xt4sa64WOrpJvZBDPNPNYg","alias":"jacobs-pickles-new-york","name":"Jacob's Pickles","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/167Rl2s1oMge_2ZSDD1z0A/o.jpg","categories":[{"alias":"comfortfood","title":"Comfort Food"},{"alias":"southern","title":"Southern"},{"alias":"tradamerican","title":"American (Traditional)"}],"location":{"address1":"509 Amsterdam Ave","address2":"","address3":"","city":"New York","zip_code":"10024","country":"US","state":"NY","display_address":["509 Amsterdam Ave","New York, NY 10024"]}},{"id":"QbAfrOxbuYKU248SDXHZEQ","alias":"totto-ramen-new-york-15","name":"Totto Ramen","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/DVRyq3tbC8DJ1V3SoC_FBQ/o.jpg","categories":[{"alias":"ramen","title":"Ramen"}],"location":{"address1":"366 W 52nd St","address2":"","address3":"","city":"New York","zip_code":"10019","country":"US","state":"NY","display_address":["366 W 52nd St","New York, NY 10019"]}},{"id":"VrCCr45dhN-RRM107iptdg","alias":"russ-and-daughters-new-york","name":"Russ & Daughters","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/VVsTMR57q-_ebqaPKM_Llg/o.jpg","categories":[{"alias":"bagels","title":"Bagels"},{"alias":"smokehouse","title":"Smokehouse"}],"location":{"address1":"179 E Houston St","address2":"","address3":"","city":"New York","zip_code":"10002","country":"US","state":"NY","display_address":["179 E Houston St","New York, NY 10002"]}},{"id":"0CjK3esfpFcxIopebzjFxA","alias":"joes-shanghai-new-york-2","name":"Joe's Shanghai","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/ekUo5egd4dlE7zJyb4-Leg/o.jpg","categories":[{"alias":"shanghainese","title":"Shanghainese"},{"alias":"seafood","title":"Seafood"}],"location":{"address1":"9 Pell St","address2":"","address3":"","city":"New York","zip_code":"10013","country":"US","state":"NY","display_address":["9 Pell St","New York, NY 10013"]}},{"id":"o6q3jm-dU5A6nV3r2lBg9A","alias":"chinatown-ice-cream-factory-new-york","name":"Chinatown Ice Cream Factory","image_url":"https://s3-media4.fl.yelpcdn.com/bphoto/qefHcdS7L4-8v88Ng4so9g/o.jpg","categories":[{"alias":"icecream","title":"Ice Cream & Frozen Yogurt"},{"alias":"desserts","title":"Desserts"}],"location":{"address1":"65 Bayard St","address2":"","address3":"","city":"New York","zip_code":"10013","country":"US","state":"NY","display_address":["65 Bayard St","New York, NY 10013"]}},{"id":"b8a-8u_A51v2IzyjLVsx6w","alias":"del-friscos-double-eagle-steakhouse-new-york","name":"Del Frisco's Double Eagle Steakhouse","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/FyQ0V-QtndWStk5B8qwjXw/o.jpg","categories":[{"alias":"steak","title":"Steakhouses"},{"alias":"newamerican","title":"American (New)"},{"alias":"seafood","title":"Seafood"}],"location":{"address1":"1221 Ave Of The Americas","address2":"","address3":"","city":"New York","zip_code":"10020","country":"US","state":"NY","display_address":["1221 Ave Of The Americas","New York, NY 10020"]}},{"id":"ikazsJps1k-Br2FbunwCtg","alias":"spot-dessert-bar-new-york-2","name":"Spot Dessert Bar","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/0WUYc9QKwyZHZ1s6niRdmA/o.jpg","categories":[{"alias":"desserts","title":"Desserts"},{"alias":"macarons","title":"Macarons"},{"alias":"creperies","title":"Creperies"}],"location":{"address1":"13 St Marks Pl","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["13 St Marks Pl","New York, NY 10003"]}},{"id":"TN4RnyqHMSupRFot4Q-_EA","alias":"ippudo-westside-new-york","name":"Ippudo Westside","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/EmJBZo1FvHemEBgyJknEOQ/o.jpg","categories":[{"alias":"ramen","title":"Ramen"}],"location":{"address1":"321 W 51st St","address2":null,"address3":"","city":"New York","zip_code":"10019","country":"US","state":"NY","display_address":["321 W 51st St","New York, NY 10019"]}},{"id":"nRO136GRieGtxz18uD61DA","alias":"eleven-madison-park-new-york","name":"Eleven Madison Park","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/-80vpN8iZykUnx6y8Q-jRw/o.jpg","categories":[{"alias":"newamerican","title":"American (New)"},{"alias":"french","title":"French"},{"alias":"cocktailbars","title":"Cocktail Bars"}],"location":{"address1":"11 Madison Ave","address2":"","address3":"","city":"New York","zip_code":"10010","country":"US","state":"NY","display_address":["11 Madison Ave","New York, NY 10010"]}},{"id":"WIhm0W9197f_rRtDziq5qQ","alias":"lombardis-pizza-new-york-4","name":"Lombardi's Pizza","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/UZ6V_hobp1KpYDPOHNoCKw/o.jpg","categories":[{"alias":"pizza","title":"Pizza"}],"location":{"address1":"32 Spring St","address2":"","address3":"","city":"New York","zip_code":"10012","country":"US","state":"NY","display_address":["32 Spring St","New York, NY 10012"]}},{"id":"dMhRafXdr765DHe0k-QfaQ","alias":"abc-kitchen-new-york","name":"ABC Kitchen","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/k2V0QyHL_IFbfDnR33S0cg/o.jpg","categories":[{"alias":"newamerican","title":"American (New)"},{"alias":"french","title":"French"}],"location":{"address1":"35 E 18th St","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["35 E 18th St","New York, NY 10003"]}},{"id":"8HkB3JfIj7_g-MN5ujoRig","alias":"grand-central-terminal-new-york","name":"Grand Central Terminal","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/t9Pl11kD4bs9J3AJRJlHyQ/o.jpg","categories":[{"alias":"landmarks","title":"Landmarks & Historical Buildings"},{"alias":"trainstations","title":"Train Stations"}],"location":{"address1":"89 E 42nd St","address2":null,"address3":"","city":"New York","zip_code":"10017","country":"US","state":"NY","display_address":["89 E 42nd St","New York, NY 10017"]}},{"id":"ehUuSk5gPTCQmwS_ubgKRA","alias":"upstate-new-york-2","name":"Upstate","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/RvnUVU7MF7DT0RzNL-EebQ/o.jpg","categories":[{"alias":"seafood","title":"Seafood"},{"alias":"wine_bars","title":"Wine Bars"},{"alias":"beerbar","title":"Beer Bar"}],"location":{"address1":"95 1st Ave","address2":"","address3":"","city":"New York","zip_code":"10003","country":"US","state":"NY","display_address":["95 1st Ave","New York, NY 10003"]}},{"id":"iBm8YTqNwrddsxWdqLPK-A","alias":"caracas-arepa-bar-new-york","name":"Caracas Arepa Bar","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/wtb4bAE2a4XHO2xlR_cMkw/o.jpg","categories":[{"alias":"venezuelan","title":"Venezuelan"},{"alias":"bars","title":"Bars"}],"location":{"address1":"91 E 7th St","address2":"","address3":"","city":"New York","zip_code":"10009","country":"US","state":"NY","display_address":["91 E 7th St","New York, NY 10009"]}},{"id":"P58WuRP1AGD9ruE2bZ2urw","alias":"dough-brooklyn","name":"Dough","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/vw6a5HENJwaZByokus4GzQ/o.jpg","categories":[{"alias":"donuts","title":"Donuts"},{"alias":"coffee","title":"Coffee & Tea"}],"location":{"address1":"448 Franklin Ave","address2":"","address3":"","city":"Brooklyn","zip_code":"11205","country":"US","state":"NY","display_address":["448 Franklin Ave","Brooklyn, NY 11205"]}},{"id":"t1w4qyqyfEdTPhoy-5t3FA","alias":"morimoto-new-york","name":"Morimoto","image_url":"https://s3-media3.fl.yelpcdn.com/bphoto/r5u2gd0GWd7O5xyVE3K7Aw/o.jpg","categories":[{"alias":"japanese","title":"Japanese"},{"alias":"sushi","title":"Sushi Bars"}],"location":{"address1":"88 10th Ave","address2":null,"address3":"","city":"New York","zip_code":"10011","country":"US","state":"NY","display_address":["88 10th Ave","New York, NY 10011"]}},{"id":"Hs1TH_4FpyzbX6_J5r1XXg","alias":"mollys-cupcakes-new-york","name":"Molly's Cupcakes","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/7N63eLWpHu-aph3MOo_Viw/o.jpg","categories":[{"alias":"bakeries","title":"Bakeries"},{"alias":"cupcakes","title":"Cupcakes"},{"alias":"customcakes","title":"Custom Cakes"}],"location":{"address1":"228 Bleecker St","address2":"","address3":"","city":"New York","zip_code":"10014","country":"US","state":"NY","display_address":["228 Bleecker St","New York, NY 10014"]}},{"id":"qLLxS7RwNEjP_jq_KQrPfA","alias":"traif-brooklyn","name":"Traif","image_url":"https://s3-media2.fl.yelpcdn.com/bphoto/_srdk7UPM4mShxAIqm9aqg/o.jpg","categories":[{"alias":"newamerican","title":"American (New)"},{"alias":"tapasmallplates","title":"Tapas/Small Plates"}],"location":{"address1":"229 S 4th St","address2":"","address3":"","city":"Brooklyn","zip_code":"11211","country":"US","state":"NY","display_address":["229 S 4th St","Brooklyn, NY 11211"]}},{"id":"OUPyV2WKYETuprScXSAtuA","alias":"the-museum-of-modern-art-new-york-3","name":"The Museum of Modern Art","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/aLAhip2kC7DkEIa4M1SzCw/o.jpg","categories":[{"alias":"artmuseums","title":"Art Museums"}],"location":{"address1":"11 West 53rd St","address2":"","address3":"","city":"New York","zip_code":"10019","country":"US","state":"NY","display_address":["11 West 53rd St","New York, NY 10019"]}},{"id":"HxC2ZN010NxAFwjTqUVpzw","alias":"rice-to-riches-new-york","name":"Rice To Riches","image_url":"https://s3-media1.fl.yelpcdn.com/bphoto/piqXaAjUb85Pt7n7CNpGVA/o.jpg","categories":[{"alias":"desserts","title":"Desserts"}],"location":{"address1":"37 Spring St","address2":"","address3":"","city":"New York","zip_code":"10012","country":"US","state":"NY","display_address":["37 Spring St","New York, NY 10012"]}}];

for(let i=0; i<restaurants.length; i++){

//console.log(restaurants[i]);
         client.index({
          index: 'restaurants',
          id: restaurants[i].id,
          body: {
            alias: restaurants[i].alias,
            name: restaurants[i].name,
            image_url: restaurants[i].image_url,
            location: restaurants[i].location,
            categories: restaurants[i].categories
          }
        }, function (err, resp, respcode) {
            console.log(err, resp, respcode);
        });
    }
      },

      async search(searchTerm) {

        let hits=[];
        let querybody = {
            "query": {
              "bool": {
                "should": [
                  {"term": {
                    "alias": {
                      "value": searchTerm
                    }
                  }},
                  {"term": {
                    "name": {
                      "value": searchTerm
                    }
                  }},
                  {"term": {
                    "categories.alias": {
                      "value": searchTerm
                    }
                  }},
                  {"term": {
                    "categories.title": {
                      "value": searchTerm
                    }
                  }}
                ]
              }
            }
          };

         await client.search({index: "restaurants", body: querybody}).then(function (body) {
            hits = body.hits.hits;
            console.log(body.hits.hits);
          }, function (error) {
            console.trace(error.message);
          });
          
          return hits;
      }
};

module.exports = exportedMethods;